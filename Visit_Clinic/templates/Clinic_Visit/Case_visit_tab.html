{% load static %}


<style>
    .checklist .checkbox {
        position: relative;
        display: block;
        margin-top: 5px;
        margin-bottom: 5px;
    }

    .checklist .checkbox+.checkbox {
        margin-top: 5px;
        margin-bottom: 5px;
    }


    .well {
        min-width: 250px;
    }

    .checklist .checkbox {
        position: relative;
        display: block;
        margin-top: 5px;
        margin-bottom: 5px;
    }

    .checklist .checkbox+.checkbox {
        margin-top: 5px;
        margin-bottom: 5px;
    }
</style>

<section class="padding-bottom-large padding-top-0 light-bg  border-light text-weight-700 ">
    <div
        class="container-fluid padding-top-small padding-right-large padding-left-large padding-bottom-large ">
        <div class="row">

            <div class="col-md-9">
                <div class="tabs-theme base nav-left">
                    <!-- Nav tabs -->
                    <ul class="nav nav-tabs text-weight-600" role="tablist">
                        <li role="presentation" class="active"><a href="#Visit_Screen" aria-controls="Visit_Screen"
                                role="tab" data-toggle="tab">Visit_Screen</a></li>
                        <li role="presentation"><a href="#Doctor_Order" aria-controls="Doctor_Order" role="tab"
                                data-toggle="tab" onClick="cheak_visit_scr('btn-order', {{data.id}})">Doctor_Order</a></li>
                        <li role="presentation"><a href="#Radiology" aria-controls="Radiology" role="tab"
                                data-toggle="tab" onClick="Patiant_xray_List()">Radiology</a></li>
                        <li role="presentation"><a href="#labotory"   aria-controls="labotory" role="tab"
                                data-toggle="tab" onClick="cheak_visit_scr('btn-tst', {{data.id}})">labotory</a></li>
                        <li role="presentation"><a href="#Admission" onClick="cheak_visit_scr('btn-Admission', {{data.id}})" aria-controls="Admission" role="tab"
                                data-toggle="tab">Admission</a></li>
                        <li role="presentation"><a href="#All_Visits" aria-controls="All_Visits" role="tab"
                                data-toggle="tab">All_Visits</a></li>
                                    <li role="presentation"><a  aria-controls="Radiology" role="tab"
                                        data-toggle="tab" onClick="Get_Files_ID()">Archive File</a></li>
                        <li role="presentation" class="dropdown">
                            <a class="dropdown-toggle" data-toggle="dropdown" href="#" role="button"
                                aria-haspopup="true" aria-expanded="false"> More <span class="caret"></span>
                            </a>
                            <ul class="dropdown-menu">
                                <li role="presentation">
                                    <a data-toggle="modal" data-target=".Transfer-modal">Transfer to another clinic</a>
                                </li>
                                <li role="presentation">
                                    <a data-toggle="modal" data-target=".Visit-Close" >Close Visit</a>
                                  
                                </li>


                              
                            </ul>
                            <div class="modal Transfer-modal animate fadeIn" data-animation="fadeIn" tabindex="-1" style="display: none;">
                                <div class="modal-dialog modal-lg" role="document">
                                    <div class="modal-content">
                                        <div class="modal-body">
                                            <button type="button" class="close" id="Patiant_Case_History"
                                                data-dismiss="modal" aria-label="Close"><span
                                                    aria-hidden="true">×</span></button>
                                                    <h4>Transfer Patient another Clinic</h4>
                                                    <hr>
                                        <div class="panel panel-light">
                                            <div class="panel-body">
                                                {% include 'Clinic_Visit/Transfer_Model.html' %}
                                            </div>
                                        </div>

                                    </div>
                                </div>
                            </div>

                       
                        </li>
                        <div class="modal Visit-Close animate fadeIn" data-animation="fadeIn" tabindex="-1" style="display: none;">
                            <div class="modal-dialog modal-md" role="document">
                                <div class="modal-content">
                                    <div class="modal-body">
                                        <button type="button" class="close" id="Patiant_Case_History"
                                            data-dismiss="modal" aria-label="Close"><span
                                                aria-hidden="true">×</span></button>
                                               

                                    <div class="panel panel-light">
                                        <div class="panel-body">
                                            <form action="{% url 'Visit_Clinic:Visit_Close'%}"
                                                        method="POST" enctype="multipart/form-data">
                                                <div class="row">
                                                    {% csrf_token %}
                                                    <div class="form-group has-success">
                                                        <input type="hidden" name="visit_Case_Close_id" maxlength="120" class="form-control"
                                                            id="visit_Case_Close_id" value="{{data.id}}">
                                                    </div>
                                                    <div class="form-row ">
                                                        {% for field in Visit_Close_Form %}
                                                        <div class="col-md-10 col-md-10">
                                                            <h4>{{ field.label }}</h4>
                                                            <div class="form-group has-success">
                                                                {{ field }}
                                                            </div>
                                                        </div>
                                                        {% endfor %}
                                                    </div>
                                                    <div class="row">
                                                        <div class="col-md-8 padding-top-0 "></div>
                                                        <div class="col-md-4">
                                                            <div class="col text-center">
                                                                <input type="submit" class="btn btn-success  btn-demo-margin-bottom"
                                                                    value="Save" />
                                                            </div>
                                                        </div>
                                                
                                                    </div>
                                                </div>
                                            </form>
                                        </div>
                                    </div>

                                </div>
                            </div>
                        </div>
                        

                       

                    </ul>
                    <!-- Tab panes -->
                    <div class="tab-content">
                        <div role="tabpanel" class="tab-pane active" id="Visit_Screen">
                            <div class="clearfix">
                                <div class="col-md-12 service light">
                                    <div class="col-md-2 col-sm-4">
                                        <button type="button"
                                            class="btn btn-base  btn-demo-margin-bottom box-shadow-active"
                                            data-toggle="modal" data-target=".Visit-Screen-modal">Add Visit Screen
                                        </button>
                                        <div class="modal Visit-Screen-modal animate fadeIn" id="Visit-Screen-modal"
                                            data-animation="fadeIn" tabindex="-1" style="display: none;">
                                            <div class="modal-dialog modal-lg" role="document">
                                                <div class="modal-content">
                                                    <div class="modal-body">
                                                        <button type="button" class="close"
                                                            id="Patiant_Case_History_close" data-dismiss="modal"
                                                            aria-label="Close"><span
                                                                aria-hidden="true">×</span></button>
                                                        <h4>New Visit Screen</h4>
                                                        <hr>
                                                        <form id="Patiant_Case_History_Save">
                                                            {% include 'Clinic_Visit/Case-history-form.html' %}
                                                        </form>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <!-- End: Small modal -->
                                    </div>

                                </div>
                            </div>
                            <div id="Visit_History"
                                class="padding-top-small padding-right-small padding-left-small padding-bottom-small margin-bottom-0 box-shadow-active">
                                <h4>Patient Visit Case History</h4>
                                <table class="table table-striped ">
                                    <tr class="bg-info">
                                        <th>History</th>
                                        <th>Diagnosis</th>
                                        <th>Examination</th>
                                        <th>Examination</th>
                                        <th>Doctor</th>
                                        <th>Visit Case Date</th>

                                    </tr>

                                    <tbody id="Case_History_Table">
                                        
                                        {% for x in visit_screan_id %}
                                        <tr>
                                            <td>{{x.History}}</td>
                                            <td>{{x.Diagnosis}}</td>
                                            <td>{{x.Examination}}</td>
                                            <td>{{x.Doctor_Note}}</td>
                                            <td>{{x.ins_user_code.first_name}}</td>
                                            <td>{{x.ins_user_date |date:'d-m-Y G:i'}}</td>

                                        </tr>
                                        {% endfor %}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <div role="tabpanel" class="tab-pane" id="Doctor_Order">
                            <div class="clearfix">
                                <div class="col-md-12 service light">
                                    <div class="col-md-2 col-sm-4">
                                        <button type="button"
                                            class="btn btn-base  btn-demo-margin-bottom box-shadow-active"
                                            data-toggle="modal" id="btn-order" data-target=".Visit-Order-modal">Add Order </button>
                                        <div class="modal Visit-Order-modal animate fadeIn" id="Visit-Order-modal"
                                            data-animation="fadeIn" tabindex="-1" style="display: none;">
                                            <div class="modal-dialog modal-lg" role="document">
                                                <div class="modal-content">
                                                    <div class="modal-body">
                                                        <button type="button" class="close"
                                                            id="Patiant_Case_Order_close" data-dismiss="modal"
                                                            aria-label="Close"><span
                                                                aria-hidden="true">×</span></button>
                                                        <h4>New Order</h4>
                                                        <hr>
                                                        <form id="Patiant_Case_Order_Save">
                                                            {% include 'Clinic_Visit/order-form.html' %}
                                                        </form>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                </div>
                            </div>
                            <div id="Case_Order_Table">
                                <h4> Order Case List</h4>
                                <table class="table table-striped padding-top-medium box-shadow-active">
                                    <tr class="bg-info">
                                        <th>Order No</th>
                                        <th>Order_Time</th>
                                        <th>Dr_Order</th>
                                        <th>Doctor</th>
                                        <th>Nurse_Note</th>
                                        <th>Nurse_Result_Time</th>
                                        <th>Order_Status</th>
                                    </tr>
                                    <tbody>
                                        {% for x in Visit_order %}
                                        <tr>
                                            <th>{{ x.id }}</th>
                                            <td>{{ x.ins_user_date |date:'d-m-Y G:i' }}</td>
                                            <td>{{ x.Dr_Order }}</td>
                                            <td>{{ x.ins_user_code.first_name }}</td>
                                            <td>{{ x.Nurse_Note }}</td>
                                            <td>{{ x.Nurse_Result_Time |date:'d-m-Y G:i' }}</td>
                                            <td>{{ x.order_status }}</td>
                                            <td>
                                                {% if x.order_status == True %}
                                                {% if x.Visit_Files %}
                                                <a href="{% url 'Nurse:order_pdf' x.id %}"
                                                    class="btn btn-base  btn-demo-margin-bottom box-shadow-active"
                                                    target="_blank">
                                                    Show Files</a>
                                                {% else %}
                                                <span class="text-muted"></span>
                                                {% endif %}
                                                {% endif %}
                                            </td>


                                        </tr>
                                        {% endfor %}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <div role="tabpanel" class="tab-pane" id="Radiology">
                            <div class="clearfix">
                                <div class="col-md-12 service light">
                                    <div class="col-md-2 col-sm-4">
                                        <button type="button"
                                            class="btn btn-base  btn-demo-margin-bottom box-shadow-active"
                                            data-toggle="modal" data-target=".Radiology_Visit" id="Add_Radiology">Add
                                            Radiology Order</button>
                                        <div class="modal Radiology_Visit animate fadeIn" id="Radiology_Visit"
                                            data-animation="fadeIn" tabindex="-1" style="display: none;">
                                            <div class="modal-dialog modal-lg" role="document">
                                                <div class="modal-content">
                                                    <div class="modal-body">
                                                        <button type="button" class="close" id="Patiant_Case_Order"
                                                            data-dismiss="modal" aria-label="Close"><span
                                                                aria-hidden="true">×</span></button>
                                                        <h4>New Radiology Order</h4>
                                                        <hr>
                                                        <form id="Patiant_Case_Xray_Save">
                                                            {% include 'Clinic_Visit/xray-form.html' %}
                                                        </form>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                </div>
                            </div>
                            <div>
                                <h4>Xray List</h4>
                                <div id="Xray_Vis_List"></div>

                            </div>
                        </div>
                    </div>
                    <div role="tabpanel" class="tab-pane" id="labotory">
                        <div class="clearfix">
                            <button type="button" class="btn btn-base  btn-demo-margin-bottom box-shadow-active"
                                onClick="lab_list('CHEM' , {{data.id}})">CHEM</button>
                            <button type="button" class="btn btn-base  btn-demo-margin-bottom box-shadow-active"
                                onClick="lab_list('BACT', {{data.id}})">BACT</button>
                            <button type="button" class="btn btn-base  btn-demo-margin-bottom box-shadow-active"
                                onClick="lab_list('VIRO', {{data.id}})">VIRO</button>
                            <button type="button" class="btn btn-base  btn-demo-margin-bottom box-shadow-active"
                                onClick="lab_list('SERO', {{data.id}})">SERO</button>
                            <button type="button" class="btn btn-base  btn-demo-margin-bottom box-shadow-active"
                                onClick="lab_list('HEMA' , {{data.id}})">HEMA</button>
                            <button type="button" class="btn btn-base  btn-demo-margin-bottom box-shadow-active"
                                onClick="lab_list('hormon', {{data.id}})">hormon</button>

                        </div>
                        <form id="patiant_no_lab_form">
                            <input type="hidden" name="visit_Order_id" maxlength="120" class="form-control"
                                id="visit_Case_id" value="{{data.id}}">
                            <input type="hidden" name="patiant_no" maxlength="120" class="form-control"
                                id="patiant_no_lab" value="{{data.Patiant_No.id}}">
                        </form>
                        <div class="well box-shadow-active">
                            <dev>
                                <input type="hidden" name="visit_Case_id" maxlength="120" class="form-control"
                                    id="lab_tybe_id">
                            </dev>
                            <div class="row checklist" id="labotory_list">

                            </div>
                            <button type="button"
                                class="btn btn-base text-weight-700 text-uppercase btn-demo-margin-bottom"
                                id="btn-tst">Send</button>
                        </div>
                    </div>
                    <div role="tabpanel" class="tab-pane" id="Admission">
                        <div class="clearfix">
                            <div class="col-md-12 service light">
                                <div class="col-md-2 col-sm-4">
                                    <button type="button" class="btn btn-base  btn-demo-margin-bottom box-shadow-active"
                                        data-toggle="modal" data-target=".Admission_Visit" id="btn-Admission">Patient Admission</button>
                                    

                                    <div class="modal Admission_Visit2 animate fadeIn" id="Admission_Visit2"
                                        data-animation="fadeIn" tabindex="-1" style="display: none;">
                                        <div class="modal-dialog modal-lg" role="document">
                                            <div class="modal-content">
                                                <div class="modal-body">

                                                    <button type="button" class="close" id="Patiant_Case_Admission"
                                                        data-dismiss="modal" aria-label="Close"><span
                                                            aria-hidden="true">×</span></button>
                                                    <h4>Send Patient To Admission2</h4>
                                                    <hr>
                                                    <form method="POST" enctype="multipart/form-data">
                                                        <div class="row">
                                                            {% csrf_token %}

                                                            <div class="form-row ">
                                                                {% for field in Admission_Case_Form %}
                                                                <div class="col-md-6 col-md-4">
                                                                    <label class="control-label">{{ field.label }}</label>
                                                                    <div class="form-group has-success">
                                                                        {{ field }}
                                                                    </div>
                                                                </div>
                                                                {% endfor %}
                                                            </div>
                                                            <div class="form-group has-success">
                                                                <input type="hidden" name="visit_Case_id"
                                                                    maxlength="120" class="form-control"
                                                                    id="visit_Case_id" value="{{data.id}}">
                                                            </div>
                                                            <div class="form-group has-success">
                                                                <input type="hidden" name="patiant_no" maxlength="120"
                                                                    class="form-control" id="patiant_no"
                                                                    value="{{data.patiant_no}}">
                                                            </div>
                                                            <br>
                                                            <div class="row">
                                                                <div class="col-md-6">
                                                                    <div class="col text-center">
                                                                        <br>
                                                                        <br>
                                                                        <input type="submit"
                                                                            class="btn btn-success  btn-demo-margin-bottom "
                                                                            value="Save" />
                                                                    </div>
                                                                </div>

                                                            </div>
                                                        </div>
                                                    </form>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="modal Admission_Visit animate bounceIn" id="Admission_Visit"
                                        data-animation="bounceIn" tabindex="-1" style="display: none;">
                                        <div class="modal-dialog modal-lg" role="document">
                                            <div class="modal-content">
                                                <div class="modal-body">

                                                    <button type="button" class="close" id="Patiant_Case_Admission"
                                                        data-dismiss="modal" aria-label="Close"><span
                                                            aria-hidden="true">×</span></button>
                                                    <h4>Send Patient To Admission</h4>
                                                    <hr>
                                                    <form action="{% url 'Visit_Clinic:Patiant_Case_Admission_Save'%}"
                                                        method="POST" enctype="multipart/form-data">
                                                        <div class="row">
                                                            {% csrf_token %}

                                                            <div class="form-row ">
                                                                {% for field in Visit_Admission_Form %}
                                                                <div class="col-md-6 col-md-4">
                                                                    <label class="control-label">{{ field.label }}</label>
                                                                    <div class="form-group has-success">
                                                                        {{ field }}
                                                                    </div>
                                                                </div>
                                                                {% endfor %}
                                                            </div>
                                                            <div class="form-group has-success">
                                                                <input type="hidden" name="visit_Case_id"
                                                                    maxlength="120" class="form-control"
                                                                    id="visit_Case_id" value="{{data.id}}">
                                                            </div>
                                                            <div class="form-group has-success">
                                                                <input type="hidden" name="patiant_no" maxlength="120"
                                                                    class="form-control" id="patiant_no"
                                                                    value="{{data.patiant_no}}">
                                                            </div>
                                                            <br>
                                                            <div class="row">
                                                                <div class="col-md-6">
                                                                    <div class="col text-center">
                                                                        <br>
                                                                        <br>
                                                                        <input type="submit"
                                                                            class="btn btn-success  btn-demo-margin-bottom "
                                                                            value="Save" />
                                                                    </div>
                                                                </div>

                                                            </div>
                                                        </div>
                                                    </form>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>
                    <div role="tabpanel" class="tab-pane" id="All_Visits">
                        <div class="clearfix">
                            {% include 'Clinic_Visit/All_Visit_Id.html' %}

                        </div>

                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-3 box-shadow-active border-light">

            <div class="margin-top-small text-left">
                <h4 class="text-weight-700 text-uppercase">Pateiant Vital Signs</h4>
                <div class="separator dark"><i class="fa fa-circle-o"></i><i class="fa fa-circle"></i><i
                        class="fa fa-circle-o"></i><span class="short-line"></span></div>
            </div>
            <div class="row">

                {% for v in vital %}
                <div class="col-sm-12 service base">
                    <div class="service-icon">
                        <i class="fa fa-copyright"></i>
                    </div>
                    <div class="service-text">
                        <h4 class="text-capitalize text-weight-600"><a href="#">Temp : </a></h4>
                        <p class="text-capitalize text-weight-400">{{v.Temp}}</p>
                    </div>
                    <div class="timeline-list"></div>
                </div>
                <div class="col-sm-12 service base">
                    <div class="service-icon">
                        <i class="fa fa-heartbeat"></i>
                    </div>
                    <div class="service-text">
                        <h4 class="text-capitalize text-weight-600">Blood Pressure :</h4>
                        <p class="text-capitalize text-weight-400">{{v.Blood_pressure}}</p>
                    </div>
                    <div class="timeline-list"></div>
                </div>
                <div class="col-sm-12 service base">
                    <div class="service-icon">
                        <i class="fa fa-gratipay"></i>
                    </div>
                    <div class="service-text">
                        <h4 class="text-capitalize text-weight-600">Spo2 :</h4>
                        <p class="text-capitalize text-weight-400">{{v.spo2}} %</p>
                    </div>
                </div>
                <div class="col-sm-12 service base">
                    <div class="service-icon">
                        <i class="fa fa-percent"></i>
                    </div>
                    <div class="service-text">
                        <h4 class="text-capitalize text-weight-600">Resp Rate :</h4>
                        <p class="text-capitalize text-weight-400">{{v.Resp_rate}}</p>
                    </div>
                </div>
                <div class="col-sm-12 service base">
                    <div class="service-icon">
                        <i class="fa fa-user"></i>
                    </div>
                    <div class="service-text">
                        <h4 class="text-capitalize text-weight-600">Height :</h4>
                        <p class="text-capitalize text-weight-400">{{v.Height}}</p>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
    </div>
</section>



{% block javascript %}
<script type="text/javascript" src="{% static 'assets/js/jquery_3.3.1_jquery.min.js' %}"></script>
<script>
    $("#id_clinic").change(function () {
        var id_clinic = $('visit_Case_id').val();
        $.ajax({
            url: "{% url 'Visit_Clinic:Get_Visit_By_Clinic_Name' %}",
            data: {
                'id_clinic': id_clinic
            },
            success: function (data) {
                $("#Clinic_list_Table").empty();
                $('#Clinic_list_Table').append(data);

            }

        });
    });


    $(document).ready(function () {
        $("#Patiant_Case_History_Save").submit(function (e) {
            // preventing from page reload and default actions
            e.preventDefault();
            // serialize the data for sending the form data.
            var formData = new $("#Patiant_Case_History_Save").serialize();

            $.ajax({
                type: 'POST',
                url: "{% url 'Visit_Clinic:Patiant_Visit_Case_Save' %}",
                data: formData,
                success: function (data) {
                    $("#Visit_History").empty();
                    $('#Visit_History').append(data);

                    $("#Patiant_Case_History_close").click();
                    $("#Patiant_Case_History_Save").trigger('reset');
                },
                error: function (response) {
                    // alert the error if any error occured

                }

            })

        })
    });
    $(document).ready(function () {
        var myorder = []
        $("#Patiant_Case_Order_Save").submit(function (e) {
            // preventing from page reload and default actions
            e.preventDefault();
            // serialize the data for sending the form data.
            var formData = new $("#Patiant_Case_Order_Save").serialize();
            $.ajax({
                type: 'POST',
                url: "{% url 'Visit_Clinic:Patiant_Case_Order_Save' %}",
                data: formData,
                success: function (data) {
                    $("#Visit-Order-modal").trigger('reset');
                    $("#Case_Order_Table").empty();
                    $('#Case_Order_Table').append(data);
                    $("#Patiant_Case_Order_Save").trigger('reset');
                    $("#Patiant_Case_Order_close").click();
                },
                error: function (response) {
                    // alert the error if any error occured

                }

            })

        })
    });

    function lab_list(lab_type, id) {
        var term = lab_type
        var lab_lis = []
        var visit_id = id
        var tybe_id = document.getElementById('lab_tybe_id')

        $.ajax({
            dataType: 'json',
            data: {
                'term': term,
                'visit_id': visit_id
            },
            url: "{% url 'labotory:get_Labotory_Tybe' %}",
            // on success
            success: function (response) {
                lab_lis = response.data
                //tybe_id.innerHTML = tybe_id_html
                document.getElementById('lab_tybe_id').value = response.tybe_id
                Lab_List_Table(lab_lis)
                document.getElementById("btn-tst").style.visibility = "visible";
            },
            // on error

        });

        return false;
    }

    function Get_Files_ID() {

var get_id = document.getElementById('visit_Case_files_id').value
$.ajax({
    url: "{% url 'Patient_Files:validate_patient_pdf_file_id'  %}",
    data: {
        'get_id' :get_id
    },
    dataType: 'json',
    success: function (data) {
        if (data.is_taken == false) {
            
            cosyAlert('<strong>Error</strong><br />' + data.error_message, 'error', { vPos: 'middle', hPos: 'center' });
            
        } else {
            
            var get_id_url = '/files/pateint/pdf/'+get_id;
        window.open(get_id_url, '_blank');
        }
        
    },

});

}
    function Lab_List_Table(data) {
        var list_lab_id = document.getElementById('labotory_list')
        $("#labotory_list").empty();
        for (var i = 0; i < data.length; i++) {

            var list_ruslet = `
            
                            
                                <div class="checkbox col-xs-6 col-sm-4 col-md-3 col-lg-2">
                                    <label style="white-space: nowrap;"><input type="checkbox" id="${data[i].id}" value="${data[i].id}" >${data[i].test_name}</label>
                                </div>
            `
            list_lab_id.innerHTML += list_ruslet


        }
    }
</script>


<script>
    var checkboxes = document.querySelectorAll('input[type="checkbox"]');
    for (var checkbox of checkboxes) {
        checkbox.checked = this.checked;
    }
    $(document).ready(function () {
        $('#btn-tst').click(function () {

            var id = [];
            $(':checkbox:checked').each(function (i) {
                id[i] = $(this).val();
            })
            if (id.length === 0) {
                alert("Please select items to delete.")
            } else {
                var patiant_no_lab = new $("#patiant_no_lab").val();
                var tybe_id = new $("#lab_tybe_id").val();
                var visit_Case_id = new $("#visit_Case_id").val();
                var formlabData = new $("#patiant_no_lab_form").serialize();
                console.log(id);
                $.ajax({
                    url: "{% url 'labotory:visit_lab_order_list' %}",
                    method: "POST",
                    data: {
                        tybe_id: tybe_id,
                        id: id,
                        visit_Case_id: visit_Case_id,
                        patiant_no_lab: patiant_no_lab,
                        csrfmiddlewaretoken: $('input[name=csrfmiddlewaretoken]').val(),
                    },
                    success: function (response) {
                        $("#labotory_list").empty();
                        $('#labotory_list').append(response);
                        document.getElementById("btn-tst").style.visibility = "hidden";
                    },
                    error: function (error) {
                        alert(error.error)
                    }
                })
            }


        })

    })


    function Visit_Lab_List_Order(data) {
        var list_lab_id = document.getElementById('labotory_list')
        $("#labotory_list").empty();
        for (var i = 0; i < data.length; i++) {
            var m = new Date(data[i].ins_user_date);
            var DateTimeFormate = m.getUTCFullYear() + "/" + (m.getUTCMonth() + 1) + "/" + m.getUTCDate() + " " + m.getUTCHours() + ":" + m.getUTCMinutes() + ":" + m.getUTCSeconds();
            var row = `<tr>
							<td>${data[i].id}</td>
							<td>${DateTimeFormate}</td>
                            <td>${data[i].Lab_Test}</td>
                            <td>${data[i].Specimens_Arrival_Status}</td>
					  </tr>`
            list_lab_id.innerHTML += row

        }
    }


    $(document).ready(function () {
        var xray_data = []
        $("#Patiant_Case_Xray_Save").submit(function (e) {
            // preventing from page reload and default actions
            e.preventDefault();
            // serialize the data for sending the form data.
            var formData = new $("#Patiant_Case_Xray_Save").serialize();
            $.ajax({
                type: 'POST',
                url: "{% url 'Visit_Clinic:Patiant_Case_Xray_Save' %}",
                data: formData,
                success: function (response) {
                    $("#Patiant_Case_Xray_Save").trigger('reset');
                    // alert("Done Xray ")
                    Patiant_xray_List()
                    document.getElementById('Radiology_Visit').click();


                },
                error: function (response) {
                    // alert the error if any error occured

                }

            })

        })
    });

   


    function rep(data) {
        var rep = document.getElementById('show_report')
        var rep = document.getElementById('show_report')
        for (var i = 0; i < data.length; i++) {
            var row_rep = `<dev>${data[i].id}</dev>`
            rep.innerHTML += row_rep

        }
    }
    function shoe_rep(report_id) {
        var rep = document.getElementById('show_report')
        var rep_data = []
        $.ajax({
            type: 'GET',
            url: "{% url 'Visit_Clinic:show_report_xray' %}",
            data: {
                'report_id': report_id
            },
            success: function (response) {

                document.getElementById("show_report").innerHTML = `<dev><p>${response.Report_time}</p>${response.Report_details}<p></p></dev>`
                document.getElementById("show_report2").innerHTML = (response.Report_time)

            },
            error: function (response) {
                // alert the error if any error occured

            }

        })
    }

    function Patiant_xray_List() {

        visit_xray = $('#visit_xray_id').val();
        var Add_Radiology = document.getElementById('Add_Radiology')
        $.ajax({
            type: 'GET',
            url: "{% url 'Visit_Clinic:xray_visit_list' %}",
            data: {
                'visit_xray': visit_xray
            },
            success: function (data) {
                if (data.is_exists == false) {
                    Add_Radiology.disabled = true;
                    cosyAlert('<strong>Error</strong><br />' + data.error_message, 'error', { vPos: 'middle', hPos: 'center' });
                } else {
                    Add_Radiology.disabled = false;
                    $('#Xray_Vis_List').html(data);
                }

            },
            error: function (response) {
                // alert the error if any error occured

            }

        })
    }

    function cheak_visit_scr(btnid , id) {
        btn = document.getElementById(btnid)


$.ajax({
    type: 'GET',
    url: "{% url 'Visit_Clinic:cheack_visit_sc' %}",
    data: {
        'id': id
    },
    success: function (data) {
        if (data.is_exists == false) {
            btn.disabled = true;
            cosyAlert('<strong>Error</strong><br />' + data.error_message, 'error', { vPos: 'middle', hPos: 'center' });
        } 

    },
    error: function (response) {
        // alert the error if any error occured

    }

})
}  

</script>
{% endblock javascript %}